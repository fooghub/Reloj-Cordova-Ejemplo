/*** Aplicación: Reloj - Javascript * Archivo: index-min.js * Autor: Francisco J. Gómez. * 2004, 2016 Foog.Software. * MIT License (MIT). * Dependencias: jQuery 1.11.3 https://jquery.com/ , - jQueryMobile 1.4.5 https://jquerymobile.com/ , - iScroll v4.2.5 ~ Copyright (c) 2012 Matteo Spinelli, http://cubiq.org , - toast v1.00 https://github.com/tutcugil/ToastJS**/ 
jQuery.fn.center=function(){this.css("position","absolute");this.css("top",Math.max(0,($(window).height()-$(this).outerHeight())/2+$(window).scrollTop())+"px");this.css("left",Math.max(0,($(window).width()-$(this).outerWidth())/2+$(window).scrollLeft())+"px");return this};String.prototype.capitalizarPrimeraLetra=function(){return this.charAt(0).toUpperCase()+this.slice(1)};
var programa={pausar:function(a){a.preventDefault();switch(programa.ventana.hoja.id){case "index":programa.ventana.panel.abierto&&$("#opciones").panel("close");""!==programa.ventana.emergente.id&&$("#"+programa.ventana.emergente.id).popup("close");break;case "ajustes":programa.navegar.enCurso||programa.actualizaciones.comprobar.enCurso||programa.actualizaciones.descargar.enCurso||$("#ajustes-regresar").trigger("click");break;case "licencia":programa.navegar.enCurso||$("#licencia-regresar").trigger("click")}programa.navegar.enCurso&&
(programa.navegar.enCurso=!1)},reanudar:function(a){a.preventDefault();switch(programa.ventana.hoja.id){case "index":programa.pantalla.centrarReloj();break;case "ajustes":programa.ventana.protector.desactivar();programa.actualizaciones.comprobar.enCurso||programa.actualizaciones.descargar.enCurso?$("#ajustes-desplegable-actualizaciones").hasClass("ui-collapsible-collapsed")||$("#ajustes-actualizaciones-botones").hasClass("ui-disabled")&&$("#ajustes-actualizaciones-botones").removeClass("ui-disabled"):
$("#ajustes-regresar").trigger("click");break;case "licencia":$("#licencia-regresar").trigger("click");break;case "calendario":programa.fecha.calendario.presentar()}},propiedades:{nombre:"Reloj",versiones:{larga:"0.0.0",corta:"0.0",tipo:"Alpha",compilado:"000"},tirada:"mes, a\u00f1o",paquete:"package",plataforma:"plataforma",serie:"serie",leerXML:function(){$.ajax({type:"GET",url:"xml/reloj.xml",dataType:"xml"}).done(function(a){$(a).find("lanzamiento").each(function(){programa.propiedades.versiones.tipo=
$(this).find("tipo").text();programa.propiedades.serie=$(this).find("serie").text();programa.propiedades.tirada=$(this).find("fecha").text();programa.fecha.fechaTirada=new programa.fecha.elaborar(programa.propiedades.tirada);programa.propiedades.tirada=programa.fecha.fechaTirada.mes+", "+programa.fecha.fechaTirada.aaaa;programa.actualizaciones.repositorio=$(this).find("protocolo").text()+$(this).find("dominio").text()+$(this).find("repositorio").text()})})}},fecha:{error:!1,elaborar:function(a){a=
a||null;var b="";try{var c,e,d,f;if(null!==a)if(isNaN(a)){if(/^\d{1,2}[./-]\d{1,2}[./-]\d{4,}$/.test(a))a=a.replace(/\/|\./g,"-"),a=a.split("-").reverse().join("-");else if(/^\d{4,}[./-]\d{1,2}[./-]\d{1,2}$/.test(a))a=a.replace(/\/|\./g,"-");else throw"Wrong date format";e=a.split("-")[2];d=a.split("-")[1];f=a.split("-")[0];1E3>f&&(f=1E3);9999<f&&(f=9999);1>d&&(d=1);12<d&&(d=12);1>e&&(e=1);e>(new Date(f,d,0)).getDate()&&(e=(new Date(f,d,0)).getDate());if(1>e||31<e||1>d||12<d)throw"Wrong date format";
if(1E3>f||9999<f)throw"Date out of range";c=new Date(f,d-1,e)}else{if(-306102276E5>parseInt(a,10)||2534022108E5<parseInt(a,10))throw"Date out of range";c=new Date(parseInt(a,10))}else c=new Date;this.d=c.getDate();this.dd=10>this.d?"0"+this.d:this.d;this.nDs=c.getDay();this.dsemana="domingo lunes martes mi\u00e9rcoles jueves viernes s\u00e1bado".split(" ")[this.nDs];this.wd="sunday monday tuesday wednesday thursday friday saturday".split(" ")[this.nDs];this.m=c.getMonth()+1;this.mm=10>this.m?"0"+
this.m:this.m;this.mes="enero febrero marzo abril mayo junio julio agosto septiembre octubre noviembre diciembre".split(" ")[c.getMonth()];this.mo="january february march april may june july august september october november december".split(" ")[c.getMonth()];this.aaaa=c.getFullYear();this.bisiesto=29===(new Date(this.aaaa,2,0)).getDate()?!0:!1;this.horas=10>c.getHours()?"0"+c.getHours():c.getHours();this.minutos=10>c.getMinutes()?"0"+c.getMinutes():c.getMinutes();this.segundos=10>c.getSeconds()?
"0"+c.getSeconds():c.getSeconds();this.uDm=(new Date(this.aaaa,this.m,0)).getDate();this.pDm=(new Date(this.aaaa,this.m-1,1)).getDay();this.marcaTemporal=Date.parse(c)}catch(g){b=g}finally{""!==b&&(programa.fecha.error=!0,programa.fecha.mostrarError(b))}},mostrarError:function(a){var b="Error Fecha<br />"+a,c,e=function(){};"Wrong date format"===a?(c="Error Fecha\nLa fecha solicitada no es correcta.\nFormatos admitidos:\ndd/MM/aaaa\naaaa/MM/dd\nDonde:\n'dd', es el d\u00eda.\n'MM' es el mes y\n'aaaa' es el a\u00f1o, con cuatro d\u00edgitos.\nEl separador puede ser:\n' / ', ' - ' \u00f3 ' . ' (punto).",
a="La fecha solicitada no es correcta.\nFormatos admitidos:\ndd/MM/aaaa \u00f3 aaaa/MM/dd\nDonde:\n'dd', es el d\u00eda.\n'MM' es el mes y\n'aaaa' es el a\u00f1o, con cuatro d\u00edgitos.\nEl separador puede ser:\n' / ', ' - ' \u00f3 ' . ' (punto)."):"Date out of range"===a?(c="Error Fecha\nLa fecha solicitada est\u00e1 fuera del rango soportado.\nM\u00ednimo:\n01/01/1000\nM\u00e1ximo:\n31/12/9999",a="La fecha solicitada est\u00e1 fuera del rango soportado.\nM\u00ednimo:\n01/01/1000\nM\u00e1ximo:\n31/12/9999"):
c="Error Fecha\n"+a;"calendario"===programa.ventana.hoja.id?navigator.notification?navigator.notification.alert(a,e,"Error Fecha","Aceptar"):alert(c):(programa.fecha.error=!1,programa.avisar(b+".",4E3,"bottom","#ff0000"))},calendario:{presentar:function(a){a=a||null;a=null===a?new programa.fecha.elaborar:new programa.fecha.elaborar(a);programa.fecha.error&&(a=new programa.fecha.elaborar,programa.fecha.error=!1);var b=a.m,c=0===a.pDm?7:a.pDm,e=c+a.uDm,d=a.aaaa,f=1;$("#calendario-anualidad").html(a.aaaa);
$("#calendario-mensualidad").html(a.mes.toUpperCase());for(var g=1;42>=g;g++)$("#calendario-"+g).hasClass("fiestaAlternativa")&&$("#calendario-"+g).removeClass("fiestaAlternativa"),$("#calendario-"+g).hasClass("fiesta")&&$("#calendario-"+g).removeClass("fiesta"),$("#calendario-"+g).hasClass("fiestaEnDomingo")&&$("#calendario-"+g).removeClass("fiestaEnDomingo"),$("#calendario-"+g).hasClass("seleccionado")&&$("#calendario-"+g).removeClass("seleccionado"),g<c||g>=e?$("#calendario-"+g).html("&#160;"):
($("#calendario-"+g).html(f),1582<=d&&0<=this.festivos(d)[b].indexOf(f)&&($("#calendario-"+g).hasClass("domingo")?$("#calendario-"+g).addClass("fiestaEnDomingo"):3===b&&19===f||7===b&&25===f?$("#calendario-"+g).addClass("fiestaAlternativa"):$("#calendario-"+g).addClass("fiesta")),f===a.d&&$("#calendario-"+g).addClass("seleccionado"),f++);$("#calendario-anualidad-retroceder").hasClass("ui-disabled")&&$("#calendario-anualidad-retroceder").removeClass("ui-disabled");$("#calendario-anualidad-avanzar").hasClass("ui-disabled")&&
$("#calendario-anualidad-avanzar").removeClass("ui-disabled");$("#calendario-campo-oculto").val("");$("#calendario-fecha").val("");$("#calendario-campo-oculto").val(a.dd+"/"+a.mm+"/"+a.aaaa);$("#calendario-fecha").val($("#calendario-campo-oculto").val());1E3===parseInt(a.aaaa,10)&&$("#calendario-anualidad-retroceder").addClass("ui-disabled");9999===parseInt(a.aaaa,10)&&$("#calendario-anualidad-avanzar").addClass("ui-disabled")},buscar:function(a){var b="",c=$("#calendario-campo-oculto").val().split("/"),
e=parseInt(c[0],10),d=parseInt(c[1],10),c=parseInt(c[2],10),f=(new Date(c,d,0)).getDate();switch(a){case "fechaSeleccionada":b=$("#calendario-fecha").val();break;case "anualidadAnterior":if(1E3!==c)2===d&&29===e&&(e=28),b=e+"/"+d+"/"+(c-1);else{$("#calendario-anualidad-retroceder").addClass("ui-disabled");return}break;case "anualidadSiguiente":if(9999>c)2===d&&29===e&&(e=28),c+=1,b=e+"/"+d+"/"+c;else return;break;case "mesAnterior":--d;0===d&&(d=12,--c);e=e>f?f:e;e=1===e.toString().length?"0"+e:e.toString();
d=1===d.toString().length?"0"+d:d.toString();c=c.toString();b=e+"/"+d+"/"+c;break;case "mesSiguiente":d+=1,12<d&&(d=1,c+=1),e=e>f?f:e,e=1===e.toString().length?"0"+e:e.toString(),d=1===d.toString().length?"0"+d:d.toString(),c=c.toString(),b=e+"/"+d+"/"+c}""!==b&&this.presentar(b)},festivos:function(a){a=parseInt(a,10);var b=[[],[],[],[],[],[],[],[],[],[],[],[],[]];1979<=a&&(b=[[],[1,6],[],[19],[],[1],[],[25],[15],[],[12],[1],[8,25]]);1984<=a&&b[12].push(6);var c=Math.floor(a/100),e=a-19*Math.floor(a/
19),d=c-Math.floor(c/4)-Math.floor((c-Math.floor((c-17)/25))/3)+19*e+15,d=d-30*Math.floor(d/30),d=d-Math.floor(d/28)*(1-Math.floor(d/28)*Math.floor(29/(d+1))*Math.floor((21-e)/11)),c=a+Math.floor(a/4)+d+2-c+Math.floor(c/4),c=c-7*Math.floor(c/7),c=d-c,d=3+Math.floor((c+40)/44),f=c+28-31*Math.floor(d/4),c=[d,f],e=4===d&&0>=f-2?[3,31-Math.abs(f-2)]:[d,f-2],d=4===d&&0>=f-3?[3,31-Math.abs(f-3)]:[d,f-3];1979<=a&&(b[d[0]].push(d[1]),b[e[0]].push(e[1]));b[c[0]].push(c[1]);return b}}},avisar:function(a,b,
c,e){switch(arguments.length-2){case 0:c="bottom";e="#000000";break;case 1:e="#000000"}switch(b){case 1E3:b=Toast.DURATION_SHORT;break;case 2E3:b=Toast.DURATION_NORMAL;break;case 3E3:b=Toast.DURACTION_AVERAGE;break;case 4E3:b=Toast.DURATION_LONG;break;default:b=Toast.DURATION_NORMAL}switch(c){case "top":c=Toast.POSITION_TOP;break;case "middle":c=Toast.POSITION_MIDDLE;break;case "bottom":c=Toast.POSITION_BOTTOM;break;default:c=Toast.POSITION_BOTTOM}Toast.show({message:a,position:c,duration:b,background:e})},
navegar:{enCurso:!1,url:function(a){this.enCurso=!0;if(!1===dispositivo.obtenerEstadoDeRed()[0])programa.avisar("No hay conexi\u00f3n ...",4E3),this.enCurso=!1;else{var b,c="sistema";switch(a){case "ajustes-web-enlace":b="http://www.foog.es/";break;case "licencia-web-enlace":b="http://www.foog.es/";break;case "ajustes-github-enlace":b="https://github.com/fooghub/Reloj-Cordova-Ejemplo",/wifi/i.test(dispositivo.obtenerEstadoDeRed()[1])&&cordova.InAppBrowser&&(c="navegadorPrograma")}"navegadorPrograma"===
c?(a=cordova.InAppBrowser.open(b,"_blank","location=yes"),a.addEventListener("exit",function(){programa.navegar.enCurso=!1})):a=window.open(b,"_system")}}},salir:function(){navigator.app?(dispositivo.sonido.id.forEach(function(a){dispositivo.sonido.remover(a)}),navigator.app.exitApp()):programa.avisar("Funci\u00f3n no operativa",3E3)},pantalla:{longitudCapaCentral:400<10*Math.round((Math.min.apply(Math,[$(window).width(),$(window).height()])-32)/10)?400:10*Math.round((Math.min.apply(Math,[$(window).width(),
$(window).height()])-32)/10),coordenadaSuperior:null,centrarReloj:function(){$.mobile.silentScroll(null===programa.pantalla.coordenadaSuperior?0:programa.pantalla.coordenadaSuperior);$("#index-capa-central").center();programa.pantalla.coordenadaSuperior=null}},teclado:{seAbre:function(){$("#ajustes-pie").is(":visible")&&$("#ajustes-pie").hide()},seCierra:function(){$("#ajustes-pie").is(":visible")||$("#ajustes-pie").show()}},ventana:{hoja:{id:"index"},desplegable:{inicializado:!1,solicitado:"",colapsar:function(a){a=
/^#/.test(a)?a:"#"+a;$(a).collapsible("collapse")},expandir:function(a){a=/^#/.test(a)?a:"#"+a;$(a).collapsible("expand")},abrirDesdePanel:function(a){a=/^#/.test(a)?a:"#"+a;$("#opciones").panel("close");programa.ventana.desplegable.solicitado=a;$.mobile.changePage("#ajustes",{transition:"slide",reverse:!0})}},panel:{abierto:!1,desplazamiento:null,situarBotones:function(a){switch(a){case "panelbeforeopen":$("#opciones-varios").height()>$("#opciones-envoltura").height()?($("#opciones-varios").hasClass("opciones-varios-abajo")&&
$("#opciones-varios").removeClass("opciones-varios-abajo"),$("#opciones-envoltura").css("overflow","auto"),programa.ventana.panel.desplazamiento=new iScroll("opciones-envoltura",{checkDOMChanges:!0,hScroll:!1,hScrollbar:!1,vScroll:!0,vScrollbar:!0,hideScrollbar:!0})):(null!==programa.ventana.panel.desplazamiento&&(programa.ventana.panel.desplazamiento.desplazamiento.destroy(),programa.ventana.panel.desplazamiento.desplazamiento=null),$("#opciones-envoltura").css("overflow","hidden"),$("#opciones-varios").hasClass("opciones-varios-abajo")||
$("#opciones-varios").addClass("opciones-varios-abajo"));break;case "panelclose":null!==programa.ventana.panel.desplazamiento&&(programa.ventana.panel.desplazamiento.destroy(),programa.ventana.panel.desplazamiento=null),$("#opciones-varios").hasClass("opciones-varios-abajo")&&$("#opciones-varios").removeClass("opciones-varios-abajo")}}},emergente:{id:"",abrir:function(a){a=/^#/.test(a)?a:"#"+a;programa.ventana.panel.abierto&&$("#opciones").panel("close");$(a).popup("open")},oscilar:function(a){var b=
/^#/.test(a)?a:"#"+a,c,e,d=$(b).offset().left,f=d+4;c=setInterval(function(){$(b).offset().left===d?$(b).offset({left:f}):$(b).offset({left:d})},10);clearTimeout(e);e=setTimeout(function(){clearInterval(c);$(b).offset({left:d})},1500)}},protector:{desplegado:!1,activar:function(a,b){b=b||!1;$("#"+a).hasClass("ui-disabled")||$("#"+a).addClass("ui-disabled");programa.ventana.protector.desplegado||(programa.ventana.protector.desplegado=!0);b&&$.mobile.loading("show")},desactivar:function(a,b){b=b||0;
var c;clearTimeout(c);c=setTimeout(function(){$("#"+a).hasClass("ui-disabled")&&$("#"+a).removeClass("ui-disabled");programa.ventana.protector.desplegado&&(programa.ventana.protector.desplegado=!1);$.mobile.loading("hide")},b)}}},reloj:{marca:"",tema:"bn",coloresYfamilia:{bn:"#FFFFFF #E0E0E0 #FFFFFF #303030 #303030 #707070 #202020 #202020 #707070 #000000 #080808 #101010 Giorgio".split(" "),ba:"#E0E0E0;#C8C8C8;#D8D8D8;#000033;#000033;#000033;#000033;#000033;#330033;#000033;#00003D;#000047;Times New Roman".split(";"),
nb:"#000000 #000000 #282828 #808080 #FFFFFF #F8F8F8 #E8E8E8 #E0E0E0 #F8F8F8 #E8E8E8 #F0F0F0 #FFFFFF Giorgio".split(" "),nr:"#000000 #000000 #282828 #800000 #F80000 #F00000 #E80000 #E00000 #F00000 #E80000 #E00000 #FF0000 Giorgio".split(" ")},dibujarEsfera:function(a,b){a.beginPath();a.arc(0,0,b,0,2*Math.PI);a.fillStyle=this.coloresYfamilia[this.tema][0];a.fill();var c=a.createRadialGradient(0,0,.95*b,0,0,1.05*b);c.addColorStop(0,"#202020");c.addColorStop(.5,"#FFFFFF");c.addColorStop(1,"#202020");a.strokeStyle=
c;a.lineWidth=.1*b;a.stroke();47<=b&&(a.fillStyle=this.coloresYfamilia[this.tema][1],a.fillRect(.303*b,.048*b,.144*b,.128*b),a.fillStyle=this.coloresYfamilia[this.tema][2],a.fillRect(.308*b,.048*b,.144*b,.128*b),a.lineWidth=.01*b,a.strokeStyle=this.coloresYfamilia[this.tema][3],a.strokeRect(.293*b,.048*b,.168*b,.144*b),""!==programa.reloj.marca&&programa.reloj.dibujarMarca(a,b))},dibujarMarca:function(a,b){a.textBaseline="middle";a.textAlign="center";a.font="400 "+.075*b+"px "+this.coloresYfamilia[this.tema][12];
a.fillStyle=this.coloresYfamilia[this.tema][4];a.fillText(this.marca,0,.24*-b);a.fillStyle=this.coloresYfamilia[this.tema][5];a.font=.074*b+"px "+this.coloresYfamilia[this.tema][12];a.fillText("reloj",0,.149*-b)},dibujarCifras:function(a,b){var c;a.font=42<=b?"Bold "+.12*b+"px "+this.coloresYfamilia[this.tema][12]:.12*b+"px "+this.coloresYfamilia[this.tema][12];a.textBaseline="middle";a.textAlign="center";a.lineCap="butt";a.strokeStyle=this.coloresYfamilia[this.tema][6];a.fillStyle=this.coloresYfamilia[this.tema][6];
if(10<b)if(47>b)for(var e=1;13>e;e++)c=e*Math.PI/6,a.rotate(c),a.translate(0,.85*-b),a.rotate(-c),a.fillText(e.toString(),0,0),a.rotate(c),a.translate(0,.85*b),a.rotate(-c);else{a.lineCap="butt";for(var e=.0078*b,d,f,g,h,l,k=1;60>=k;k++){c=Math.PI/30*k;d=Math.sin(c);f=Math.cos(c);if(0===k%5){a.lineWidth=.04*b;c=95*d*e;g=-95*f*e;h=120*d*e;l=-120*f*e;d=80*d*e;f=-80*f*e;var m=" I II III IV V VI VII VIII IX X XI XII".split(" ");"ba"===this.tema?a.fillText(m[k/5],d,f):a.fillText(k/5,d,f)}else a.lineWidth=
.011*b,c=110*d*e,g=110*f*e,h=120*d*e,l=120*f*e;a.beginPath();a.moveTo(c,g);a.lineTo(h,l);a.stroke()}}},dibujarAguja:function(a,b,c,e){a.beginPath();a.lineWidth=e;a.lineCap="round";a.moveTo(0,0);a.rotate(b);a.lineTo(0,-c);a.stroke();a.rotate(-b)},cronometrar:function(a,b){var c=new Date,e=c.getDate(),d=c.getHours(),f=12<d?"PM":"AM";""!==this.marca&&(f=f.toLowerCase());var g=c.getMinutes(),h=c.getSeconds(),c=c.getFullYear();47<=b&&(a.fillStyle=this.coloresYfamilia[this.tema][7],a.font="ba"===this.tema?
"bold "+.084*b+"px "+this.coloresYfamilia[this.tema][12]:"bold "+.078*b+"px "+this.coloresYfamilia[this.tema][12],a.fillText(e,2===e.toString().length?.378*b:.374*b,"ba"===this.tema?.122*b:.135*b),a.fillStyle=this.coloresYfamilia[this.tema][8],a.font=.074*b+"px "+this.coloresYfamilia[this.tema][12],a.fillText(f,0,.17*b),a.fillText(c,0,.265*b));a.strokeStyle=this.coloresYfamilia[this.tema][9];d=d%12*Math.PI/6+g*Math.PI/360+h*Math.PI/21600;programa.reloj.dibujarAguja(a,d,.5*b,.07*b);a.strokeStyle=this.coloresYfamilia[this.tema][10];
g=g*Math.PI/30+h*Math.PI/1800;programa.reloj.dibujarAguja(a,g,.8*b,.07*b);a.strokeStyle=this.coloresYfamilia[this.tema][11];h=h*Math.PI/30;programa.reloj.dibujarAguja(a,h,.9*b,.02*b);a.beginPath();a.arc(0,0,.1*b,0,2*Math.PI);a.fillStyle=this.coloresYfamilia[this.tema][11];a.strokeStyle=this.coloresYfamilia[this.tema][11];a.fill()},cargar:function(a,b){programa.reloj.dibujarEsfera(a,b);programa.reloj.dibujarCifras(a,b);programa.reloj.cronometrar(a,b)},accionar:function(){var a,b,c;a=document.getElementById("reloj");
b=a.getContext("2d");c=a.height/2;b.translate(c,c);c*=.94;setInterval(function(){programa.reloj.cargar(b,c)},1E3)}},restaurarFormulario:function(a,b){b=b||null;switch(a){case "ajustes-formulario-marca":$("#ajustes-marca-entrada-texto").val("");$("#ajustes-marca-campo-oculto").val("");$("#ajustes-marca-entrada-texto").textinput("disable");$("#ajustes-marca-guardar-cambios").button("disable");$("#ajustes-marca-advertencia").html("<span style='color:#696969;'>(M\u00e1ximo dieciocho caracteres)</span>");
$("#ajustes-marca-actual").html(""===programa.reloj.marca?"(no tiene)":programa.reloj.marca);""===programa.reloj.marca?($("#ajustes-marca-alternativa-editar").checkboxradio("enable"),$("#ajustes-marca-alternativa-editar").prop("checked",!1).checkboxradio("refresh"),$("#ajustes-marca-alternativa-eliminar").prop("checked",!1).checkboxradio("refresh"),$("#ajustes-marca-alternativa-eliminar").checkboxradio("disable")):($("#ajustes-marca-alternativa-editar").checkboxradio("enable"),$("#ajustes-marca-alternativa-editar").prop("checked",
!1).checkboxradio("refresh"),$("#ajustes-marca-alternativa-eliminar").checkboxradio("enable"),$("#ajustes-marca-alternativa-eliminar").prop("checked",!1).checkboxradio("refresh"));break;case "ajustes-formulario-tema":$("#ajustes-tema-guardar-cambios").button("disable");$("#ajustes-tema-campo-oculto").val("");$("input:radio[name=ajustes-temas]:checked").val()!==programa.reloj.tema&&($("input:radio[name=ajustes-temas]:checked").prop("checked",!1).checkboxradio("refresh"),$('input[type="radio"][value="'+
programa.reloj.tema+'"]').prop("checked",!0).checkboxradio("refresh"));$("#ajustes-tema-actual").html(programa.reloj.tema.toUpperCase());break;case "ajustes-formulario-sonido":dispositivo.sonido.tictac||"on"!==$("#ajustes-sonido-tictac").val()||$("#ajustes-sonido-tictac").val("off").flipswitch("refresh");"off"===$("#ajustes-sonido-tictac").val()?$("#ajustes-sonido-advertencia").css("color","#696969"):$("#ajustes-sonido-advertencia").css("color","#FFFFFF");break;case "ajustes-formulario-captura":$("#ajustes-captura-advertencia").css("color",
"#696969");$("#ajustes-captura-guardar-cambios").button("disable");$("input:radio[name=ajustes-captura-formato]:checked").val()!==programa.capturaDePantalla.formato&&($("input:radio[name=ajustes-captura-formato]:checked").prop("checked",!1).checkboxradio("refresh"),$('input[type="radio"][value="'+programa.capturaDePantalla.formato+'"]').prop("checked",!0).checkboxradio("refresh"));$("input:radio[name=ajustes-captura-calidad]:checked").val()!==programa.capturaDePantalla.calidad&&($("input:radio[name=ajustes-ajustes-captura-calidad]:checked").prop("checked",
!1).checkboxradio("refresh"),$('input[type="radio"][value="'+programa.capturaDePantalla.calidad+'"]').prop("checked",!0).checkboxradio("refresh"));break;case "ajustes-formulario-actualizaciones":programa.actualizaciones.versiones.nueva="";programa.actualizaciones.versiones.ruta="";programa.actualizaciones.error="";$("#ajustes-actualizaciones-tarea").html("&#160;");$("#ajustes-actualizaciones-barra-progreso").val(0).slider("refresh");$("#ajustes-actualizaciones-barra-progreso").slider("disable");"collapsibleexpand"===
b&&$("#ajustes-actualizaciones-barra-progreso").next().find(".ui-slider-handle").hide();$("#ajustes-actualizaciones-porcentaje-cifra").text("0");$("#ajustes-actualizaciones-porcentaje").hasClass("ui-disabled")&&$("#ajustes-actualizaciones-porcentaje").removeClass("ui-disabled");$("#ajustes-actualizaciones-porcentaje").css("visibility","hidden");$("#ajustes-actualizaciones-noticia").html("&#160;");$("#ajustes-actualizaciones-noticia1").html("&#160;");$("#ajustes-actualizaciones-error").html("&#160;");
"Comprobar"!==$("#ajustes-actualizaciones-guardar-cambios").val()&&$("#ajustes-actualizaciones-guardar-cambios").val("Comprobar").button("refresh");/wifi|ethernet|desconocida/i.test(dispositivo.obtenerEstadoDeRed()[1])?($("#ajustes-actualizaciones-guardar-cambios").button("enable"),$("#ajustes-actualizaciones").html("Versi\u00f3n instalada:&#160;"+programa.propiedades.versiones.larga)):($("#ajustes-actualizaciones").html("<span><img src='img/check-white.png' alt=''></span><span>&#160;&#160;S\u00f3lo con WiFi</span>"),
$("#ajustes-actualizaciones-guardar-cambios").button("disable"));break;case "ajustes-formulario-dispositivo":"collapsibleexpand"===b&&($("#ajustes-dispositivo-tipo").html(dispositivo.propiedades.tipo),$("#ajustes-dispositivo-red").html(dispositivo.obtenerEstadoDeRed()[1]),$("#ajustes-dispositivo-modelo").html(dispositivo.propiedades.modelo),$("#ajustes-dispositivo-sistema").html(dispositivo.propiedades.plataforma.nombre+" "+dispositivo.propiedades.plataforma.versiones),$("#ajustes-dispositivo-pantalla").html(dispositivo.propiedades.dimensiones),
$("#ajustes-dispositivo-pantalla-pr").html(dispositivo.propiedades.ratio),$("#ajustes-dispositivo-uuid").html(dispositivo.propiedades.uuid),""!==dispositivo.acumulador.nivel?$("#ajustes-dispositivo-acumulador-nivel").text(dispositivo.acumulador.nivel):$("#ajustes-dispositivo-acumulador-nivel").text("X"),dispositivo.acumulador.conectado?$("#ajustes-dispositivo-acumulador-conectado").text("(Conectado y cargando)"):$("#ajustes-dispositivo-acumulador-conectado").html("&#160;"));break;case "ajustes-formulario-acerca":"collapsibleexpand"===
b&&($("#ajustes-programa-versiones-corta").text(programa.propiedades.versiones.corta),$("#ajustes-programa-versiones-cordova").html((/android/i.test(dispositivo.propiedades.plataforma.nombre)," y el  marco de desarrollo multiplataforma Apache Cordova&#8482; (versi\u00f3n "+dispositivo.propiedades.cordova+").")),$("#ajustes-programa-nombre").text(programa.propiedades.nombre),$("#ajustes-programa-paquete").html("Id: "+programa.propiedades.paquete),$("#ajustes-programa-serie").html("Serie: "+programa.propiedades.serie),
$("#ajustes-programa-versiones-tirada").html(programa.propiedades.tirada.capitalizarPrimeraLetra()),$("#ajustes-dispositivo-plataforma").html(dispositivo.propiedades.plataforma.nombre),$("#ajustes-programa-versiones-larga").text(programa.propiedades.versiones.larga),$("#ajustes-programa-versiones-tipo").html(" - "+programa.propiedades.versiones.tipo),$("#ajustes-programa-versiones-guarismo").html("Compilaci\u00f3n: "+programa.propiedades.versiones.compilado),$("#ajustes-copyright-anualidad-corriente").text(programa.fecha.sistema.aaaa))}},
guardarCambios:function(a){var b,c,e=a.replace("formulario","desplegable"),d=!1;switch(a){case "ajustes-formulario-marca":b="marca";"editar"===$("#ajustes-marca-campo-oculto").val()?(c=$.trim($("#ajustes-marca-entrada-texto").val()),""===c?(programa.avisar("No has escrito ninguna marca para el reloj",4E3,"bottom"),$("#ajustes-marca-entrada-texto").focus()):c=18<c.length?c.substring(0,18):c):"eliminar"===$("#ajustes-marca-campo-oculto").val()&&(c="####################");d=!0;break;case "ajustes-formulario-tema":b=
"tema";c=-1!==$.inArray($("#ajustes-tema-campo-oculto").val(),["bn","ba","nb","nr"])?$("#ajustes-tema-campo-oculto").val():"bn";d=!0;break;case "ajustes-formulario-captura":b="imagen";programa.capturaDePantalla.formato=$("input:radio[name=ajustes-captura-formato]:checked").val();programa.capturaDePantalla.calidad=$("input:radio[name=ajustes-captura-calidad]:checked").val();c=programa.capturaDePantalla.formato+"|"+programa.capturaDePantalla.calidad;programa.capturaDePantalla.pendiente=!0;programa.ventana.desplegable.colapsar("#ajustes-desplegable-captura");
$("#ajustes-regresar").trigger("click");break;case "ajustes-formulario-actualizaciones":"comprobar"===$("#ajustes-actualizaciones-guardar-cambios").val().toLowerCase()?(programa.restaurarFormulario(a),programa.actualizaciones.comprobar.consulta()):"descargar"===$("#ajustes-actualizaciones-guardar-cambios").val().toLowerCase()?programa.actualizaciones.descargar.transferencia():"instalar"===$("#ajustes-actualizaciones-guardar-cambios").val().toLowerCase()&&programa.actualizaciones.instalar()}d&&(null===
dispositivo.baseDeDatos?("marca"===b?programa.reloj.marca="####################"===c?"":c:"tema"===b&&(programa.reloj.tema=c),programa.ventana.desplegable.colapsar("#"+e),programa.ventana.protector.activar("ajustes",!0),programa.ventana.protector.desactivar("ajustes"),$("#ajustes-regresar").trigger("click"),programa.avisar("OK!",4E3)):(programa.ventana.desplegable.colapsar("#"+e),programa.ventana.protector.activar("ajustes",!0),dispositivo.modificarBaseDeDatos(b,c)))},capturaDePantalla:{pendiente:!1,
enCurso:!1,formato:"jpg",calidad:"50",preparar:function(){programa.capturaDePantalla.enCurso=!0;$("#captura-de-pantalla").popup("close");dispositivo.sonido.reproducir("clic")},procesar:function(){var a,b,c,e,d;try{c=document.getElementById("reloj"),c.getContext("2d"),e=new Image,e.id="reloj_"+Math.round(+new Date+Math.random()),e.src=c.toDataURL(),$("#index-capa-central").center(),$("#imagen-reloj").css({width:programa.pantalla.longitudCapaCentral+"px",height:programa.pantalla.longitudCapaCentral+
"px"}),$("#imagen-reloj").prepend(e),$("#imagen-reloj").center()}catch(f){a=f}finally{d=void 0===e?"undefined":e.id,void 0!==a?programa.capturaDePantalla.finalizar("procesar",a,d):(clearTimeout(b),b=setTimeout(function(){programa.capturaDePantalla.guardar(d)},1E3))}},guardar:function(a){dispositivo.disponible?(dispositivo.sonido.reproducir("obturador"),navigator.screenshot.save(function(b,c){b?programa.capturaDePantalla.finalizar("guardar",b,a):programa.capturaDePantalla.finalizar("guardar","OK",
a)},programa.capturaDePantalla.formato,parseInt(programa.capturaDePantalla.calidad,10),a)):programa.capturaDePantalla.finalizar("guardar","Funci\u00f3n no operativa ...",a)},finalizar:function(a,b,c){c=c||"undefined";"guardar"===a&&"OK"===b?programa.avisar("Captura de pantalla en tu galer\u00eda de im\u00e1genes",4E3,"bottom"):"guardar"===a&&"OK"!==b?programa.avisar("Captura de pantalla<br />No fue posible guardar la imagen<br />"+b,4E3,"bottom","#ff0000"):programa.avisar("Error en captura de pantalla ...<br />"+
b,4E3,"bottom","#ff0000");"undefined"!==c&&$("#"+c).remove();$("#imagen-reloj").css({top:"0px",left:"0px",width:"0px",height:"0px"});programa.capturaDePantalla.enCurso=!1}},actualizaciones:{versiones:{nueva:"",rutaRemota:"",archivoNombre:"",peso:0,pesoTexto:"",fecha:null,fechaTexto:""},error:!1,interfazConsulta:null,interfazTransferencia:null,repositorio:"http://your_web_domain/your_repository/",rutaLocal:"",comprobar:{enCurso:!1,error:{num:"",mensaje:""},consulta:function(){programa.actualizaciones.comprobar.enCurso=
!0;programa.ventana.protector.activar("ajustes");$("#ajustes-actualizaciones-tarea").html("Comprobando&#160;&#8230;");$("#ajustes-actualizaciones-barra-progreso").val(0).slider("refresh");programa.actualizaciones.comprobar.progreso(0,46,!1);programa.actualizaciones.interfazConsulta=$.ajax({url:programa.actualizaciones.repositorio,dataType:"json",type:"POST",timeout:1E4,success:!1,data:{nombre:programa.propiedades.nombre.toLowerCase(),versionesCorriente:programa.propiedades.versiones.larga,paquete:programa.propiedades.paquete,
serie:programa.propiedades.serie,plataforma:dispositivo.propiedades.plataforma.nombre.toLowerCase()}}).done(function(){this.success=!0}).always(function(a,b){this.success&&a.acierto?a.resultado?a.estreno&&(programa.actualizaciones.versiones.nueva=a.versiones.nueva,programa.actualizaciones.versiones.rutaRemota=a.versiones.url,programa.actualizaciones.versiones.archivoNombre=programa.actualizaciones.versiones.rutaRemota.substring(programa.actualizaciones.versiones.rutaRemota.lastIndexOf("/")+1),!1===
a.versiones.peso||isNaN(a.versiones.peso)||(programa.actualizaciones.versiones.peso=parseInt(a.versiones.peso,10),programa.actualizaciones.versiones.pesoTexto=1E6<=programa.actualizaciones.versiones.peso?(parseFloat(programa.actualizaciones.versiones.peso)/1E6).toFixed(2)+" MB":(parseFloat(programa.actualizaciones.versiones.peso)/1E3).toFixed(2)+" KB"),!1===a.versiones.fecha||isNaN(a.versiones.fecha)||(programa.actualizaciones.versiones.fecha=parseInt(a.versiones.fecha,10),programa.actualizaciones.versiones.fechaTexto=
new Date(programa.actualizaciones.versiones.fecha))):(programa.actualizaciones.error=!0,programa.actualizaciones.comprobar.error.mensaje=a.error,programa.actualizaciones.comprobar.error.num=/^\d/.test(programa.actualizaciones.comprobar.error.mensaje)?"":"503"):(programa.actualizaciones.error=!0,0===a.status&&"timeout"!==b?(programa.actualizaciones.comprobar.error.num="403",programa.actualizaciones.comprobar.error.mensaje="Same origin policy"):0===a.status&&"timeout"===b?(programa.actualizaciones.comprobar.error.num=
"408",programa.actualizaciones.comprobar.error.mensaje="Request timeout"):"200"===a.status.toString()?(programa.actualizaciones.comprobar.error.num="500",programa.actualizaciones.comprobar.error.mensaje="Internal server error"):(programa.actualizaciones.comprobar.error.num=a.status.toString(),programa.actualizaciones.comprobar.error.mensaje=espuesta.statusText));clearInterval(programa.actualizaciones.intervaloProgreso);programa.actualizaciones.comprobar.progreso(parseInt($("#ajustes-actualizaciones-barra-progreso").val(),
10),100,!0)})},intervaloProgreso:null,progreso:function(a,b,c){b=100<b?100:b;var e=(c=c||!1)?10:100,d=100<a?100:a;$("#ajustes-actualizaciones-botones").hasClass("ui-disabled")||$("#ajustes-actualizaciones-botones").addClass("ui-disabled");$("#ajustes-actualizaciones-barra-progreso").slider("enable");$("#ajustes-actualizaciones-barra-progreso").val(d).slider("refresh");$("#ajustes-actualizaciones-porcentaje-cifra").text(d);$("#ajustes-actualizaciones-porcentaje").css("visibility","visible");programa.actualizaciones.intervaloProgreso=
setInterval(function(){d++;d>=b||100<=d?(clearInterval(programa.actualizaciones.intervaloProgreso),programa.actualizaciones.intervaloProgreso=null,$("#ajustes-actualizaciones-barra-progreso").val(d).slider("refresh"),$("#ajustes-actualizaciones-porcentaje-cifra").text(d),c&&($("#ajustes-actualizaciones-porcentaje").hasClass("ui-disabled")||$("#ajustes-actualizaciones-porcentaje").addClass("ui-disabled"),$("#ajustes-actualizaciones-botones").hasClass("ui-disabled")&&$("#ajustes-actualizaciones-botones").removeClass("ui-disabled"),
$("#ajustes-actualizaciones-barra-progreso").slider("disable"),programa.actualizaciones.comprobar.finalizado())):($("#ajustes-actualizaciones-barra-progreso").val(d).slider("refresh"),$("#ajustes-actualizaciones-porcentaje-cifra").text(d))},e)},finalizado:function(){var a="",b="Comprobar",c="&#160;";programa.actualizaciones.error?(a="<div>No se han encontrado nuevas versiones.</div>",c="Error: "+programa.actualizaciones.comprobar.error.num+" - "+programa.actualizaciones.comprobar.error.mensaje):""!==
programa.actualizaciones.versiones.nueva&&""!==programa.actualizaciones.versiones.rutaRemota?(a="<div>Hay una nueva versi\u00f3n de la aplicaci\u00f3n disponible:</div><div>Reloj "+programa.actualizaciones.versiones.nueva+"</div><div>Si quieres, puedes &#171;<b>Descargar</b>&#187; ahora el paquete de instalaci\u00f3n.</div>",b="Descargar"):a="<div>No hay nuevas versiones disponibles.</div><div>La aplicaci\u00f3n Reloj "+programa.propiedades.versiones.larga+" est\u00e1 actualizada.</div>";programa.ventana.protector.desactivar("ajustes");
programa.actualizaciones.error=!1;$("#ajustes-actualizaciones-tarea").html("&#160;");$("#ajustes-actualizaciones-noticia").html(a);$("#ajustes-actualizaciones-error").html(c);$("#ajustes-actualizaciones-guardar-cambios").val(b).button("refresh");"Comprobar"===b&&$("#ajustes-actualizaciones-guardar-cambios").button("disable");programa.actualizaciones.error&&(programa.actualizaciones.error=!1);programa.actualizaciones.comprobar.enCurso=!1}},cancelar:function(){programa.ventana.protector.desactivar("ajustes");
programa.actualizaciones.comprobar.enCurso||programa.actualizaciones.descargar.enCurso?(programa.actualizaciones.comprobar.enCurso&&(programa.actualizaciones.interfazConsulta.abort(),programa.actualizaciones.comprobar.enCurso=!1),programa.actualizaciones.descargar.enCurso&&(programa.actualizaciones.interfazTransferencia.abort(),programa.actualizaciones.descargar.enCurso=!1),$("#ajustes-actualizaciones-error").append("<div>(Operation Cancelled)</div>")):programa.ventana.desplegable.colapsar("ajustes-desplegable-actualizaciones")},
descargar:{enCurso:!1,error:{num:"",mensaje:""},transferencia:function(){programa.actualizaciones.error&&(programa.actualizaciones.error=!1);programa.actualizaciones.descargar.enCurso=!0;programa.ventana.protector.activar("ajustes");$("#ajustes-actualizaciones-tarea").html("Descargando&#160;&#8230;");$("#ajustes-actualizaciones-barra-progreso").slider("enable");$("#ajustes-actualizaciones-barra-progreso").val(0).slider("refresh");$("#ajustes-actualizaciones-botones").hasClass("ui-disabled")||$("#ajustes-actualizaciones-botones").addClass("ui-disabled");
$("#ajustes-actualizaciones-porcentaje-cifra").text("0");$("#ajustes-actualizaciones-porcentaje").hasClass("ui-disabled")&&$("#ajustes-actualizaciones-porcentaje").removeClass("ui-disabled");$("#ajustes-actualizaciones-noticia").html("&#160;");$("#ajustes-actualizaciones-noticia1").html("&#160;");$("#ajustes-actualizaciones-noticia").html("<div>Archivo:</div><div><span>"+programa.actualizaciones.versiones.archivoNombre+"</span>"+(!1!==programa.actualizaciones.versiones.peso?"<span style='font-size:x-small;'>&#160;("+
programa.actualizaciones.versiones.pesoTexto+")</span><span>.&#160;Para Reloj&#160;"+programa.actualizaciones.versiones.nueva+"</span></div>":"<span>.&#160;Para Reloj&#160;"+programa.actualizaciones.versiones.nueva+"</span></div>"));window.requestFileSystem?(programa.actualizaciones.interfazTransferencia=new FileTransfer,null!==programa.actualizaciones.interfazTransferencia?(programa.actualizaciones.interfazTransferencia.download(encodeURI(programa.actualizaciones.versiones.rutaRemota),cordova.file.externalCacheDirectory+
programa.actualizaciones.versiones.archivoNombre,function(a){programa.actualizaciones.error=!1;$("#ajustes-actualizaciones-barra-progreso").val(100).slider("refresh");$("#ajustes-actualizaciones-porcentaje-cifra").text("100");$("#ajustes-actualizaciones-tarea").html("Verificando&#160;&#8230;");a.isFile?a.file(function(a){void 0!==a.name&&dispositivo.modificarBaseDeDatos("limpieza",a.name.toString());isNaN(a.size)||parseInt(a.size,10)===programa.actualizaciones.versiones.peso||(programa.actualizaciones.error=
!0)}):programa.actualizaciones.error=!0;programa.actualizaciones.rutaLocal=a.toURL;var b;clearTimeout(b);b=setTimeout(function(){programa.actualizaciones.descargar.finalizado()},1E3)},function(a){programa.actualizaciones.error=!0;programa.actualizaciones.descargar.error.num=void 0!==a.code?a.code:"";switch(programa.actualizaciones.descargar.error.num.toString()){case "1":programa.actualizaciones.descargar.error.mensaje="File not found";break;case "2":programa.actualizaciones.descargar.error.mensaje=
"Invalid URL";break;case "3":programa.actualizaciones.descargar.error.mensaje="Connection fails";break;case "4":programa.actualizaciones.descargar.error.mensaje="Abort";break;case "5":programa.actualizaciones.descargar.error.mensaje="Not modified";break;default:programa.actualizaciones.descargar.error.mensaje="Undefined"}programa.actualizaciones.descargar.finalizado()}),programa.actualizaciones.interfazTransferencia.onprogress=function(a){a.lengthComputable&&(a=Math.floor(a.loaded/a.total*100),$("#ajustes-actualizaciones-barra-progreso").val(a).slider("refresh"),
$("#ajustes-actualizaciones-porcentaje-cifra").text(a))}):(programa.actualizaciones.error=!0,programa.actualizaciones.descargar.error.num="400",programa.actualizaciones.descargar.error.mensaje="Bad request",programa.actualizaciones.descargar.finalizado())):(programa.actualizaciones.error=!0,programa.actualizaciones.descargar.error.num="4",programa.actualizaciones.descargar.error.mensaje="Invalid state",programa.avisar("Funci\u00f3n no operativa",4E3),programa.actualizaciones.descargar.finalizado())},
finalizado:function(){programa.actualizaciones.descargar.enCurso=!1;var a="",b="Descargar",c="&#160;";programa.ventana.protector.desactivar("ajustes");$("#ajustes-actualizaciones-tarea").html("&#160;");$("#ajustes-actualizaciones-barra-progreso").slider("disable");$("#ajustes-actualizaciones-porcentaje").hasClass("ui-disabled")||$("#ajustes-actualizaciones-porcentaje").addClass("ui-disabled");$("#ajustes-actualizaciones-botones").hasClass("ui-disabled")&&$("#ajustes-actualizaciones-botones").removeClass("ui-disabled");
programa.actualizaciones.error?($("#ajustes-actualizaciones-guardar-cambios").button("disable"),a=parseInt($("#ajustes-actualizaciones-barra-progreso").val(),10),a=0===a||isNaN(a)?"<div>No ha sido posible descargar el archivo.</div>":0<a&&100>a?"<div>Descarga incompleta.</div>":"<div>No super\u00f3 la prueba de verificaci\u00f3n.</div>",c="Error: "+programa.actualizaciones.descargar.error.num+" - "+programa.actualizaciones.descargar.error.mensaje,programa.actualizaciones.error&&(programa.actualizaciones.error=
!1)):(a="<div>Descarga completa.</div><div>Si quieres, puedes &#171;<b>Instalar</b>&#187; ahora la nueva versi\u00f3n.</div>",$("#ajustes-actualizaciones-guardar-cambios").button("enable"),b="Instalar");$("#ajustes-actualizaciones-noticia1").html("&#160;");$("#ajustes-actualizaciones-noticia1").html(a);$("#ajustes-actualizaciones-error").html(c);$("#ajustes-actualizaciones-guardar-cambios").val(b).button("refresh")}},limpiar:function(a){var b=function(a){var b="";switch(a.code){case FileError.QUOTA_EXCEEDED_ERR:b=
"QUOTA EXCEEDED";break;case FileError.NOT_FOUND_ERR:b="FILE NOT FOUND";break;case FileError.SECURITY_ERR:b="SECURITY ERR";break;case FileError.INVALID_MODIFICATION_ERR:b="INVALID MODIFICATION";break;case FileError.INVALID_STATE_ERR:b="INVALID STATE";break;default:b="Unknown"}programa.avisar("Limpieza de archivos residuales:<br />Error - "+b,4E3);dispositivo.modificarBaseDeDatos("limpieza","x.xxx")};window.resolveLocalFileSystemURL(cordova.file.externalCacheDirectory,function(c){c.getFile(a,{create:!1},
function(a){a.remove(function(){programa.avisar("Limpieza de archivos residuales: Completa.",4E3);dispositivo.modificarBaseDeDatos("limpieza","x.xxx")},b)},b)},b)},instalar:function(){window.plugins.webintent.startActivity({action:window.plugins.webintent.ACTION_VIEW,url:cordova.file.externalCacheDirectory+programa.actualizaciones.versiones.archivoNombre,type:"application/vnd.android.package-archive"},function(){},function(a){$("#ajustes-actualizaciones-noticia1").html("&#160;");$("#ajustes-actualizaciones-noticia1").html("<div>No ha sido posible abrir el paquete de instalaci\u00f3n.</div>");
$("#ajustes-actualizaciones-error").html("Error: Failed to open file via 'Android Intent'");$("#ajustes-actualizaciones-guardar-cambios").button("disable");programa.actualizaciones.limpiar(programa.actualizaciones.versiones.archivoNombre)})}}},dispositivo={disponible:!1,propiedades:{cordova:"cordova",plataforma:{nombre:"sistema",versiones:"versi\u00f3n"},uuid:"uuid",tipo:"dispositivo",modelo:"modelo",dimensiones:screen.width+" &#215; "+screen.height+" p\u00edxeles",ratio:void 0!==window.devicePixelRatio||
""!==window.devicePixelRatio?parseFloat(window.devicePixelRatio).toFixed(2).toString():"?"},acumulador:{nivel:"",conectado:!1,examinar:function(a){dispositivo.acumulador.nivel=a.level;dispositivo.acumulador.conectado=a.isPlugged}},obtenerEstadoDeRed:function(){var a=[!1,"Ninguna"],b="Ninguna";if("connection"in navigator){var b=navigator.connection.type,c={};c[Connection.UNKNOWN]="Desconocida";c[Connection.ETHERNET]="Ethernet";c[Connection.WIFI]="WiFi";c[Connection.CELL_2G]="2G";c[Connection.CELL_3G]=
"3G";c[Connection.CELL_4G]="4G";c[Connection.CELL]="Tel\u00e9fono";c[Connection.NONE]="Ninguna";b=c[b];a[0]="Ninguna"===b?!1:!0;a[1]=b}else navigator.onLine&&(a[0]=!0,a[1]="Desconocida");return a},preparado:function(){document.addEventListener("backbutton",dispositivo.escucharTeclaRetorno,!1);document.addEventListener("menubutton",dispositivo.escucharTeclaOpciones,!1);document.addEventListener("pause",programa.pausar,!1);document.addEventListener("resume",programa.reanudar,!1);window.addEventListener("batterystatus",
dispositivo.acumulador.examinar,!1);window.addEventListener("native.keyboardshow",programa.teclado.seAbre);window.addEventListener("native.keyboardhide",programa.teclado.seCierra);cordova.getAppVersion.getAppName(function(a){programa.propiedades.nombre=a});cordova.getAppVersion.getVersionNumber(function(a){programa.propiedades.versiones.larga=a;a=a.split(".");programa.propiedades.versiones.corta=1<a.length?a[0]+"."+a[1]:a});cordova.getAppVersion.getVersionCode(function(a){programa.propiedades.versiones.compilado=
a});cordova.getAppVersion.getPackageName(function(a){programa.propiedades.paquete=a});programa.propiedades.plataforma=device.platform;dispositivo.propiedades.cordova=device.cordova;dispositivo.propiedades.plataforma.nombre=device.platform;dispositivo.propiedades.plataforma.versiones=device.version;dispositivo.propiedades.uuid=device.uuid;dispositivo.propiedades.modelo=device.model;dispositivo.propiedades.tipo=window.isTablet?"Tablet":"Smartphone";dispositivo.sonido.id.forEach(function(a){dispositivo.sonido.cargar(a)});
dispositivo.abrirBaseDeDatos();dispositivo.leerBaseDeDatos(!0);dispositivo.disponible=!0},escucharTeclaRetorno:function(a){a.preventDefault();if(!programa.ventana.protector.desplegado)switch(programa.ventana.hoja.id){case "index":programa.ventana.panel.abierto?$("#opciones").panel("close"):""!==programa.ventana.emergente.id?$("#"+programa.ventana.emergente.id).popup("close"):programa.ventana.emergente.abrir("#salida");break;case "ajustes":$("#ajustes-regresar").trigger("click");break;case "licencia":$("#licencia-regresar").trigger("click");
break;case "calendario":$("#calendario-regresar").trigger("click")}},escucharTeclaOpciones:function(a){a.preventDefault();if("index"===programa.ventana.hoja.id)if(""===programa.ventana.emergente.id)programa.ventana.panel.abierto?$("#opciones").panel("close"):$("#opciones").panel("open");else switch(programa.ventana.emergente.id){case "bienvenida":$("#bienvenida").popup("close");$("#opciones").panel("open");break;case "captura-de-pantalla":$("#captura-de-pantalla-cerrar").focus();break;case "salida":programa.ventana.emergente.oscilar("#salida")}},
sonido:{id:["clic","obturador","tictac"],activo:[],tictac:!1,cargar:function(a){var b="mp3/"+a+".mp3";"complex"===("tictac"===a?"complex":"simple")?window.plugins.NativeAudio.preloadComplex(a,b,1,1,0,function(b){-1===dispositivo.sonido.activo.indexOf(a)&&dispositivo.sonido.activo.push(a)},function(b){programa.avisar("Sonido Error:<br />("+a+".mp3)<br />"+b,4E3)}):window.plugins.NativeAudio.preloadSimple(a,b,function(b){-1===dispositivo.sonido.activo.indexOf(a)&&dispositivo.sonido.activo.push(a)},
function(b){programa.avisar("Sonido Error:<br />("+a+".mp3)<br />"+b,4E3)})},reproducir:function(a){-1===dispositivo.sonido.activo.indexOf(a)&&dispositivo.sonido.cargar(a);"tictac"===a?(window.plugins.NativeAudio.loop("tictac"),dispositivo.sonido.tictac=!0):window.plugins.NativeAudio.play(a)},detener:function(a){"tictac"===a&&(dispositivo.sonido.tictac=!1);window.plugins.NativeAudio.stop(a)},remover:function(a){"tictac"===a&&(dispositivo.sonido.tictac=!1);window.plugins.NativeAudio.unload(a);dispositivo.sonido.activo.splice(dispositivo.sonido.activo.indexOf(a),
1)}},baseDeDatos:null,abrirBaseDeDatos:function(){window.sqlitePlugin&&(dispositivo.baseDeDatos=window.sqlitePlugin.openDatabase({name:"reloj.db",createFromLocation:1}))},leerBaseDeDatos:function(a){a=a||!1;if(null!==dispositivo.baseDeDatos){dispositivo.baseDeDatos.transaction(function(a){a.executeSql("SELECT marca, tema, sonido, imagen, limpieza, versiones FROM ajustes WHERE id = 1;",[],b,dispositivo.detectarBaseDeDatosErrorLectura)});var b=function(b,e){programa.reloj.marca="####################"===
e.rows.item(0).marca?"":e.rows.item(0).marca;programa.reloj.tema=e.rows.item(0).tema;a&&("x.xxx"!==e.rows.item(0).limpieza&&programa.actualizaciones.limpiar(e.rows.item(0).limpieza),e.rows.item(0).versiones<programa.propiedades.versiones.larga&&dispositivo.modificarBaseDeDatos("versiones",programa.propiedades.versiones.larga))}}},modificarBaseDeDatos:function(a,b){"marca"===a&&(b="####################"!==b&&18<b.length?b.substring(0,18):b);var c=function(b){dispositivo.leerBaseDeDatos(!1);if("marca"===
a||"tema"===a){var c;clearTimeout(c);c=setTimeout(function(){programa.ventana.protector.desactivar("ajustes");$("#ajustes-regresar").trigger("click");dispositivo.sonido.reproducir("clic")},2E3)}"versiones"===a&&programa.ventana.emergente.abrir("#bienvenida")};null!==dispositivo.baseDeDatos&&dispositivo.baseDeDatos.transaction(function(e){e.executeSql("UPDATE ajustes SET "+a+"='"+b+"' WHERE id = 1;",[],c,dispositivo.detectarBaseDeDatosErrorEscritura)})},detectarBaseDeDatosErrorLectura:function(a,b){programa.avisar("Se ha producido un error de lectura en la base de datos de la aplicaci\u00f3n",
4E3,"bottom","#ff0000");if("ajustes"===programa.ventana.hoja.id){var c;clearTimeout(c);c=setTimeout(function(){programa.ventana.protector.desactivar("ajustes");$("#ajustes-regresar").trigger("click")},2E3)}},detectarBaseDeDatosErrorEscritura:function(a,b){programa.avisar("Se ha producido un error de escritura en la base de datos de la aplicaci\u00f3n",4E3,"bottom","#ff0000");if("ajustes"===programa.ventana.hoja.id){var c;clearTimeout(c);c=setTimeout(function(){programa.ventana.protector.desactivar("ajustes");
$("#ajustes-regresar").trigger("click")},500)}}};
$(document).on("pagecreate","#index",function(a){$("#index-capa-central").css("width",programa.pantalla.longitudCapaCentral+"px").css("height",programa.pantalla.longitudCapaCentral+"px");$("#index-capa-central").center();$("#reloj").css("width",programa.pantalla.longitudCapaCentral+"px").css("height",programa.pantalla.longitudCapaCentral+"px");document.getElementsByTagName("canvas")[0].width=programa.pantalla.longitudCapaCentral;document.getElementsByTagName("canvas")[0].height=programa.pantalla.longitudCapaCentral;
$("#ajustes-capa-central").css("width",programa.pantalla.longitudCapaCentral+"px").css("max-width",programa.pantalla.longitudCapaCentral+"px");$("#captura-de-pantalla, #salida, #acerca-de, #bienvenida").css("min-width",programa.pantalla.longitudCapaCentral-72+"px");$("#captura-de-pantalla, #salida, #acerca-de, #bienvenida").css("max-width",programa.pantalla.longitudCapaCentral+"px");programa.fecha.sistema=new programa.fecha.elaborar;programa.reloj.accionar();programa.propiedades.leerXML();$(window).on("orientationchange",
function(a){a.preventDefault();programa.ventana.panel.abierto&&$("#opciones").panel("close");""!==programa.ventana.emergente.id&&$("#"+programa.ventana.emergente.id).popup("close");programa.pantalla.centrarReloj()});$("#index-capa-central").click(function(a){a.preventDefault();$("#opciones").panel("open")});$(document).on("pagecontainerbeforehide",function(){"ajustes"===programa.ventana.hoja.id&&$("#ajustes-conjunto-desplegable").children().collapsible("collapse")});$(document).on("pagecontainerbeforeshow",
function(a,c){programa.ventana.hoja.id=c.toPage[0].id;switch(programa.ventana.hoja.id){case "index":programa.pantalla.coordenadaSuperior=$("#index").offset().top;break;case "ajustes":$("#ajustes-ocultable-versiones-corta").text(programa.propiedades.versiones.corta);break;case "licencia":$("#licencia-programa-versiones-corta").text(programa.propiedades.versiones.corta);$(".licencia-copyright-anualidad-corriente").text(programa.fecha.sistema.aaaa);break;case "calendario":programa.fecha.calendario.presentar()}});
$(document).on("pagecontainershow",function(a,c){switch(programa.ventana.hoja.id){case "index":null!==programa.pantalla.coordenadaSuperior&&$.mobile.silentScroll(programa.pantalla.coordenadaSuperior);programa.pantalla.centrarReloj();programa.capturaDePantalla.pendiente&&(programa.capturaDePantalla.pendiente=!1,programa.ventana.emergente.abrir("#captura-de-pantalla"));break;case "ajustes":$("#ajustes-pie").is(":visible")||$("#ajustes-pie").show(),""!==programa.ventana.desplegable.solicitado&&programa.ventana.desplegable.expandir(programa.ventana.desplegable.solicitado)}});
document.addEventListener("touchmove",function(a){null!==programa.ventana.panel.desplazamiento&&a.preventDefault()},!1);$("#opciones").on("panelbeforeopen",function(a,c){$(".ui-panel").css("max-width",parseInt(.9*$(window).width(),10)+"px");programa.ventana.panel.situarBotones(a.type)});$("#opciones").on("panelopen",function(a,c){programa.ventana.panel.abierto=!0}).on("panelclose",function(a,c){a.preventDefault();programa.ventana.panel.abierto=!1;programa.ventana.panel.situarBotones(a.type)});$("#salida, #bienvenida").on("popupbeforeposition",
function(){"salida"===this.id&&$("#salida-versiones").text(programa.propiedades.versiones.larga);"bienvenida"===this.id&&($("#bienvenida-versiones").text(programa.propiedades.versiones.larga),$("#bienvenida-anualidad").text(programa.fecha.sistema.aaaa))});$("#salida, #captura-de-pantalla, #bienvenida").on("popupafteropen",function(){programa.ventana.emergente.id=this.id}).on("popupafterclose",function(){"captura-de-pantalla"===this.id&&programa.capturaDePantalla.enCurso&&programa.capturaDePantalla.procesar();
programa.ventana.emergente.id=""});$("#ajustes-conjunto-desplegable").children().on("collapsiblecollapse",function(a,c){programa.ventana.desplegable.inicializado&&$.mobile.silentScroll(0);"ajustes-desplegable-calendario"!==this.id&&programa.ventana.desplegable.inicializado&&(this.id.replace("desplegable","formulario"),programa.restaurarFormulario(this.id,a.type))});$("#ajustes-conjunto-desplegable").children().on("collapsibleexpand",function(a,c){programa.ventana.desplegable.inicializado||(programa.ventana.desplegable.inicializado=
!0);"ajustes-desplegable-calendario"===this.id&&$("#ajustes-calendario-hoy").text(programa.fecha.sistema.dsemana.capitalizarPrimeraLetra()+","+programa.fecha.sistema.d+" de "+programa.fecha.sistema.mes+" de "+programa.fecha.sistema.aaaa);var e=this.id.replace("desplegable","formulario");programa.restaurarFormulario(e,a.type);$("html, body").animate({scrollTop:$(this).offset().top-54});programa.ventana.desplegable.solicitado=""});$(document).on("change","#ajustes-marca-alternativa-editar",function(){$("#ajustes-marca-campo-oculto").val("editar");
$("#ajustes-marca-entrada-texto").textinput("enable");$("#ajustes-marca-entrada-texto").val("");$("#ajustes-marca-entrada-texto").focus();$("#ajustes-marca-advertencia").html("<span style='color:#FFFFFF;'>(M\u00e1ximo dieciocho caracteres)</span>");$("#ajustes-marca-guardar-cambios").is(":disabled")&&$("#ajustes-marca-guardar-cambios").button("enable")});$(document).on("change","#ajustes-marca-alternativa-eliminar",function(){$("#ajustes-marca-campo-oculto").val("eliminar");$("#ajustes-marca-entrada-texto").val("");
$("#ajustes-marca-entrada-texto").textinput("disable");$("#ajustes-marca-advertencia").html("Guardar cambios&#160;&#8594;&#160;Eliminar\u00e1 la marca actual del reloj");$("#ajustes-marca-guardar-cambios").is(":disabled")&&$("#ajustes-marca-guardar-cambios").button("enable")});$(document).on("change","input:radio[name=ajustes-temas]",function(){$("#ajustes-tema-campo-oculto").val($("input:radio[name=ajustes-temas]:checked").val());$("#ajustes-tema-guardar-cambios").is(":disabled")&&$("#ajustes-tema-guardar-cambios").button("enable")});
$(document).on("change","input:radio[name=ajustes-captura-formato], input:radio[name=ajustes-captura-calidad]",function(){$("#ajustes-captura-guardar-cambios").is(":disabled")&&($("#ajustes-captura-guardar-cambios").button("enable"),$("#ajustes-captura-advertencia").css("color","#FFF"))});$("#ajustes-sonido-tictac").on("change",function(){"on"===$("#ajustes-sonido-tictac").val()?($("#ajustes-sonido-advertencia").css("color","#FFF"),dispositivo.sonido.tictac||(window.plugins&&window.plugins.NativeAudio?
dispositivo.sonido.reproducir("tictac"):(dispositivo.sonido.tictac=!1,programa.avisar("Funci\u00f3n no operativa",3E3,"bottom")))):($("#ajustes-sonido-advertencia").css("color","#696969"),dispositivo.sonido.tictac&&(window.plugins&&window.plugins.NativeAudio?dispositivo.sonido.detener("tictac"):(dispositivo.sonido.tictac=!1,programa.avisar("Funci\u00f3n no operativa",3E3,"bottom"))))});$("#ajustes-actualizaciones-cancelar").click(function(){programa.actualizaciones.cancelar()});document.addEventListener("deviceready",
dispositivo.preparado,!1)});
